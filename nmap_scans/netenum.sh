#!/bin/bash          
IP=$1
MASK=${2:-24}

if [ -z "$IP" -o -z "$MASK" ]
then
  echo "Usage: $0 network [mask]"
  echo "Mask defaults to 24."
  exit 1
fi

ip route show dev tap0
#netdiscover -i tap0 -r $IP/$MASK
nmap -sn $IP/$MASK -oG test
cat test |awk '/Up$/ {print $2}' > targets.txt
nmap -sS -sU -p53 -n -iL targets.txt
nmap -sT -p53 -iL targets.txt
nmap -sn -PR $IP/$MASK
nmap -sU -p 161 -iL targets.txt
nmap -n -sn -PS22,135,443,445 -iL targets.txt
nmap -sS -n --script smb-os-discovery -iL targets.txt
nmap -sS -sV -n -iL targets.txt
#nmap -AO -iL targets.txt
#nmap -sTV -iL targets.txt
